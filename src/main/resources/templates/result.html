<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>추천 결과</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .condition-box {
            background-color: #f1f3f5; /* 차분한 밝은 회색 */
            border: 1px solid #dee2e6; /* 부드러운 테두리 */
            border-radius: 8px;
        }
    </style>
</head>

<body class="bg-light">

<div class="container mt-5">
    <h2 class="mb-4 text-center">📈 공모주 추천 결과</h2>

    <!-- 🔹 선택한 검색 조건 요약 박스 -->
    <div class="condition-box mb-4 p-3"
         style="background-color: #f4f4f7; border-left: 4px solid #6c757d; border-radius: 6px;">

        <h6 class="fw-bold mb-2">🔎 검색 조건 요약</h6>

        <!-- 최소 경쟁률 -->
        <div th:if="${minRate != null}">
            최소 경쟁률 ≥ <b th:text="${minRate}"></b>
        </div>

        <!-- 최대 공모가 -->
        <div th:if="${maxPrice != null}">
            최대 공모가 ≤ <b th:text="${maxPrice}"></b> 원
        </div>

        <!-- 시장 -->
        <div th:if="${market != null and market != ''}">
            시장: <b th:text="${market}"></b>
        </div>

        <!-- 산업군 -->
        <div th:if="${industry != null and industry != ''}">
            산업군: <b th:text="${industry}"></b>
        </div>

        <!-- 날짜 범위 -->
        <div th:if="${startDate != null or endDate != null}">
            공모일:
            <b th:text="${startDate != null ? startDate : '전체'}"></b>
            ~
            <b th:text="${endDate != null ? endDate : '전체'}"></b>
        </div>

        <!-- 정렬 기준 한국어 라벨 처리 -->
        <div th:if="${sort != null and sort != ''}">
            정렬 기준:
            <b th:switch="${sort}">
                <span th:case="'rateDesc'">경쟁률 높은 순</span>
                <span th:case="'rateAsc'">경쟁률 낮은 순</span>
                <span th:case="'priceDesc'">공모가 높은 순</span>
                <span th:case="'priceAsc'">공모가 낮은 순</span>
                <span th:case="'dateDesc'">공모일 최신 순</span>
                <span th:case="'dateAsc'">공모일 빠른 순</span>
                <span th:case="*">기본 순</span>
            </b>
        </div>

        <!-- 어떤 조건도 없을 때 -->
        <div th:if="${minRate == null and maxPrice == null
                and (market == null or market == '')
                and (industry == null or industry == '')
                and startDate == null and endDate == null
                and (sort == null or sort == '')}">
            <b>조건 없음 (전체 보기)</b>
        </div>
    </div>


    <!-- 결과 개수 -->
    <p class="text-muted" th:text="|검색 결과 총 ${result.size()}건|"></p>

    <!-- 결과 테이블 -->
    <table class="table table-bordered table-hover mt-3">
        <thead class="table-light">
        <tr>
            <th>기업명</th>
            <th>산업군</th>
            <th>시장</th>
            <th>공모가</th>
            <th>경쟁률</th>
            <th>주관사</th>
            <th>공모일</th>
        </tr>
        </thead>

        <tbody>
        <tr th:each="ipo : ${result}">
            <td th:text="${ipo.company.name}"></td>
            <td th:text="${ipo.company.industry}"></td>
            <td th:text="${ipo.market}"></td>
            <td th:text="${ipo.offeringPrice}"></td>
            <td th:text="${ipo.competitionRate}"></td>
            <td th:text="${ipo.underwriter.name}"></td>
            <td th:text="${ipo.ipoDate}"></td>
        </tr>
        </tbody>
    </table>

    <!-- 버튼 영역 -->
    <div class="d-grid gap-2 mt-4 mb-5">
        <a href="/" class="btn btn-primary">다시 추천받기</a>
        <a href="/recommend" class="btn btn-secondary">전체 보기</a>
    </div>
</div>

</body>
</html>
